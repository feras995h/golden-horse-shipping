# ๐ ุฏููู ุงููุดุฑ - Golden Horse Shipping

## ๐ ุฌุฏูู ุงููุญุชููุงุช
1. [ุงููุดููุฉ ูุงูุญู](#ุงููุดููุฉ-ูุงูุญู)
2. [ุงููููุงุช ุงููููุฉ](#ุงููููุงุช-ุงููููุฉ)
3. [ุฎุทูุงุช ุงููุดุฑ ุงูุณุฑูุนุฉ](#ุฎุทูุงุช-ุงููุดุฑ-ุงูุณุฑูุนุฉ)
4. [ุงูุชุญูู ูู ุงููุฌุงุญ](#ุงูุชุญูู-ูู-ุงููุฌุงุญ)
5. [ุงุณุชูุดุงู ุงูุฃุฎุทุงุก](#ุงุณุชูุดุงู-ุงูุฃุฎุทุงุก)

---

## ๐ ุงููุดููุฉ ูุงูุญู

### โ ุงููุดููุฉ
```
Error: getaddrinfo EAI_AGAIN base
[TypeOrmModule] Unable to connect to the database
```

### โ ุงูุญู
ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุบูุฑ ูุญุฏุฏุฉ ุจุดูู ุตุญูุญ ูู Coolify. ุงููุธุงู ูุญุงูู ุงูุงุชุตุงู ุจูุถูู ูุณูู "base" ุจุฏูุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุนููุฉ.

### ๐ฏ ุงูุฅุตูุงุญุงุช ุงููุทุจูุฉ
1. โ ุชุญุฏูุซ `backend/src/config/database.config.ts` ูุฅุนุทุงุก ุฃููููุฉ ูููุชุบูุฑุงุช ุงููุฑุฏูุฉ
2. โ ุฅุถุงูุฉ ุฑุณุงุฆู ุชุตุญูุญ ุดุงููุฉ ููุชุชุจุน
3. โ ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช ุจูุฌุงุญ
4. โ ุชูุซูู ูุงูู ููุฅุนุฏุงุฏุงุช ุงููุทููุจุฉ

---

## ๐ ุงููููุงุช ุงููููุฉ

### ููุจุฏุก ุงูุณุฑูุน (ุงุจุฏุฃ ููุง! ๐)
- **`ุฎุทูุงุช-ุณุฑูุนุฉ-ูููุดุฑ.txt`** - ุฏููู ุณุฑูุน ุจุงูุนุฑุจูุฉ (3 ุฏูุงุฆู)
- **`RECOMMENDED_ENV_VARS.txt`** - ุงููุชุบูุฑุงุช ุงูููุตู ุจูุง (ูุณุฎ ููุตู ูุจุงุดุฑ)

### ููุชูุงุตูู ุงููุงููุฉ
- **`DATABASE_CONNECTION_TEST_RESULTS.md`** - ูุชุงุฆุฌ ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช
- **`DEPLOYMENT_FIXES_SUMMARY.md`** - ููุฎุต ุดุงูู ููุฅุตูุงุญุงุช
- **`COOLIFY_DEPLOYMENT_GUIDE.md`** - ุฏููู ูุดุฑ ุชูุตููู

### ูููุงุช ุฅุถุงููุฉ
- **`coolify-env-variables.txt`** - ูุงุฆูุฉ ุดุงููุฉ ุจุฌููุน ุงููุชุบูุฑุงุช
- **`backend/test-db-connection.js`** - ุณูุฑูุจุช ูุงุฎุชุจุงุฑ ุงูุงุชุตุงู

---

## โก ุฎุทูุงุช ุงููุดุฑ ุงูุณุฑูุนุฉ

### 1๏ธโฃ ุงูุชุญ Coolify
```
Dashboard โ Your Project โ Environment Variables
```

### 2๏ธโฃ ุงุญุฐู ุงููุชุบูุฑุงุช ุงููุฏููุฉ
ุงุญุฐู ุฃู ูุชุบูุฑุงุช ูุฏููุฉ ุฎุงุตุฉ ุจูุงุนุฏุฉ ุงูุจูุงูุงุชุ ุจุงูุฃุฎุต:
- DB_SSL
- DB_SSL_REJECT_UNAUTHORIZED
- ุฃู ูุชุบูุฑ ูุญุชูู ุนูู "base"

### 3๏ธโฃ ุฃุถู ุงููุชุบูุฑุงุช ุงูุฌุฏูุฏุฉ
ุงูุณุฎ ุงููุชุบูุฑุงุช ูู ููู **`RECOMMENDED_ENV_VARS.txt`**

ุฃู ุฃุถู ูุฐู ุงููุชุบูุฑุงุช ุงูุฃุณุงุณูุฉ:
```bash
DATABASE_URL=postgres://postgres:A93zhpdV6icewK6rxbBQRScmxZvyWAhjvXg2QJApIKzU0gVx8CzubNgvo2O97n1l@72.60.92.146:5433/postgres
NODE_ENV=production
PORT=3000
BACKEND_PORT=3001
FRONTEND_PORT=3000
DB_SYNCHRONIZE=true
JWT_SECRET=GoldenHorse-JWT-Secret-Key-2024-Production-Change-This
JWT_EXPIRES_IN=7d
```

ูููุงุฆูุฉ ุงููุงููุฉุ ุฑุงุฌุน `RECOMMENDED_ENV_VARS.txt`.

### 4๏ธโฃ ุงุญูุธ ูุฃุนุฏ ุงููุดุฑ
1. ุงููุฑ **Save**
2. ุงููุฑ **Redeploy**
3. ุงูุชุธุฑ ุงูุชูุงู ุงูุจูุงุก (3-5 ุฏูุงุฆู)

---

## โ ุงูุชุญูู ูู ุงููุฌุงุญ

### ูู ุณุฌูุงุช Coolifyุ ูุฌุจ ุฃู ุชุฑู:

**โ ุฑุณุงุฆู ุงููุฌุงุญ:**
```
๐ Database Configuration Debug:
  - DATABASE_URL: postgres://postgres:...
  - Is PostgreSQL: true
โ Using DATABASE_URL

[Nest] LOG [NestFactory] Starting Nest application...
[Nest] LOG [InstanceLoader] TypeOrmModule dependencies initialized +29ms
[Nest] LOG [InstanceLoader] PassportModule dependencies initialized +0ms

โ Ready in XXXms
- Local: http://localhost:3000
```

**โ ูุง ูุฌุจ ุฃู ุชุฑู:**
```
Error: getaddrinfo EAI_AGAIN base
Unable to connect to the database
The server does not support SSL connections
```

---

## ๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ูุง ูุฒุงู ุฎุทุฃ "base" ูุธูุฑ
**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
- ุงููุชุบูุฑุงุช ุบูุฑ ูุญุฏุฏุฉ ูู Coolify
- ุงููุชุบูุฑุงุช ุชุญุชูู ุนูู ูุณุงูุงุช ูุจู/ุจุนุฏ ุงูููู

**ุงูุญู:**
1. ุงุญุฐู ุฌููุน ูุชุบูุฑุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. ุฃุนุฏ ุฅุถุงูุฉ `DATABASE_URL` ููุท
3. ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ูุณุงูุงุช
4. ุฃุนุฏ ุงููุดุฑ

### ุงููุดููุฉ: "Unable to connect to the database"
**ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:**
- ุงูุจูุฑุช 5433 ุบูุฑ ูุชุงุญ
- ุฌุฏุงุฑ ุงูุญูุงูุฉ ูููุน ุงูุงุชุตุงู
- ูููุฉ ุงููุฑูุฑ ุฎุงุทุฆุฉ

**ุงูุญู:**
1. ุชุญูู ูู ุฃู ุงูุจูุฑุช 5433 ููุชูุญ
2. ุฌุฑุจ ุงูุงุชุตุงู ูู Coolify server:
   ```bash
   psql "postgres://postgres:PASSWORD@72.60.92.146:5433/postgres"
   ```
3. ุชุญูู ูู ุตุญุฉ ุจูุงูุงุช ุงูุงุนุชูุงุฏ

### ุงููุดููุฉ: "The server does not support SSL connections"
**ุงูุณุจุจ:**
ุฅุถุงูุฉ ูุชุบูุฑุงุช SSL ุจุงูุฎุทุฃ

**ุงูุญู:**
ุงุญุฐู ูุฐู ุงููุชุบูุฑุงุช ุฅุฐุง ูุงูุช ููุฌูุฏุฉ:
- DB_SSL
- DB_SSL_REJECT_UNAUTHORIZED

ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุง ุชุฏุนู SSLุ ู `DATABASE_URL` ูุนูู ุจุฏูููุง ุจุดูู ูุซุงูู.

### ุงููุดููุฉ: ุงูุฌุฏุงูู ุบูุฑ ููุฌูุฏุฉ
**ุงูุณุจุจ:**
`DB_SYNCHRONIZE` ุบูุฑ ูุญุฏุฏ ุฃู = false

**ุงูุญู:**
ูู ุงููุดุฑ ุงูุฃููุ ุงุณุชุฎุฏู:
```bash
DB_SYNCHRONIZE=true
```

ุจุนุฏ ุงููุดุฑ ุงูุฃููุ ุบููุฑู ุฅูู:
```bash
DB_SYNCHRONIZE=false
```

---

## ๐ ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑ

ุชู ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ุจูุงุนุฏุฉ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ุณูุฑูุจุช ุฎุงุต:

```bash
node backend/test-db-connection.js
```

**ุงููุชุงุฆุฌ:**
- โ DATABASE_URL: **ูุฌุญ** โ ุงุณุชุฎุฏู ูุฐุง
- โ ูุชุบูุฑุงุช ูููุตูุฉ ูุน SSL: ูุดู (SSL ุบูุฑ ูุฏุนูู)

**ุงูุชูุตูุฉ ุงูููุงุฆูุฉ:** ุงุณุชุฎุฏู `DATABASE_URL` ููุท.

ุฑุงุฌุน `DATABASE_CONNECTION_TEST_RESULTS.md` ููุชูุงุตูู ุงููุงููุฉ.

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ

### 1. DATABASE_URL ูู ุงูุญู ุงูููุตู ุจู
```bash
โ DATABASE_URL=postgres://postgres:PASSWORD@72.60.92.146:5433/postgres
```

### 2. ูุง ุชุณุชุฎุฏู SSL
```bash
โ DB_SSL=true  # ุฎุทุฃ - ุงูุฎุงุฏู ูุง ูุฏุนู SSL
โ DB_SSL_REJECT_UNAUTHORIZED=false  # ุฎุทุฃ - ุบูุฑ ูุทููุจ
```

### 3. DB_SYNCHRONIZE ูููุดุฑ ุงูุฃูู ููุท
```bash
โ DB_SYNCHRONIZE=true   # ุงููุดุฑ ุงูุฃูู - ููุดุฆ ุงูุฌุฏุงูู
โ DB_SYNCHRONIZE=false  # ุงูุฅูุชุงุฌ - ูุญุงูุธ ุนูู ุงูุจูุงูุงุช
```

### 4. ุบููุฑ JWT_SECRET
```bash
โ๏ธ JWT_SECRET=GoldenHorse-JWT-Secret-Key-2024-Production-Change-This
```
ุบููุฑู ุฅูู ูููุฉ ุนุดูุงุฆูุฉ ูุขููุฉ ูู ุงูุฅูุชุงุฌ.

---

## ๐ฏ ุงูุฎูุงุตุฉ

| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **ูุงุนุฏุฉ ุงูุจูุงูุงุช** | PostgreSQL 17.6 |
| **ุงููุถูู** | 72.60.92.146:5433 |
| **SSL** | ุบูุฑ ูุฏุนูู (ููุง ููุญุชุงุฌ) |
| **ุงูุทุฑููุฉ ุงูููุตู ุจูุง** | DATABASE_URL |
| **ุงูุญุงูุฉ** | โ ุชู ุงูุงุฎุชุจุงุฑ ูุฌุงูุฒ ูููุดุฑ |

---

## ๐ ุงูุฏุนู ุงูููู

### ุงุฎุชุจุงุฑ ุงูุงุชุตุงู ูุญููุงู
```bash
cd backend
node test-db-connection.js
```

### ุฅูุดุงุก ูุณุชุฎุฏู ุฅุฏุงุฑู
```bash
cd backend
node create-admin-postgres.js
```

**ุจูุงูุงุช ุงูุฏุฎูู ุงูุงูุชุฑุงุถูุฉ:**
- Username: `admin`
- Password: `admin123`

---

## ๐ ุจุนุฏ ุงููุดุฑ ุงููุงุฌุญ

1. โ ุงุฎุชุจุฑ ุชุณุฌูู ุงูุฏุฎูู ููุณุคูู
2. โ ุบููุฑ `DB_SYNCHRONIZE` ุฅูู `false`
3. โ ุบููุฑ `JWT_SECRET` ุฅูู ูููุฉ ุขููุฉ
4. โ ุญุฏูุซ `CORS_ORIGIN` ููุทุงูู ุงููุญุฏุฏ
5. โ ุฃูุดุฆ ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

---

## ๐ ุงูููุงุฑุฏ

- **ุงูุชูุซูู ุงููุงูู:** `DEPLOYMENT_FIXES_SUMMARY.md`
- **ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑ:** `DATABASE_CONNECTION_TEST_RESULTS.md`
- **ุฏููู Coolify:** `COOLIFY_DEPLOYMENT_GUIDE.md`
- **ูุชุบูุฑุงุช ุงูุจูุฆุฉ:** `RECOMMENDED_ENV_VARS.txt`

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2 ุฃูุชูุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ:** 1.0.0  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ูููุดุฑ ุนูู Coolify

---

## ๐ ุดูุฑุงู ูุงุณุชุฎุฏุงู Golden Horse Shipping!

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงููุ ุฑุงุฌุน ุงููููุงุช ุงููุฐููุฑุฉ ุฃุนูุงู ุฃู ุงูุญุต ุณุฌูุงุช Coolify.

